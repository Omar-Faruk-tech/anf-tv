<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="ANF-tv Official website">
  <link rel="icon" type="image/png" href="./public/Images/tv logo 2.png"/>
  <meta name="keywords" content="news,anf,tv,politics,sports,business,culture,africa,nigeria,entertainment,science,technology">
  <title>ANF-tv</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
  <link rel="stylesheet" href="./css/header.css">
  <link rel="stylesheet" href="./css/add-news.css">
  <link rel="stylesheet" href="./css/footer.css">
</head>
<body>
  <div class="modal" id="modal-background">
    <div id="close" onclick="closeNav()">
      <i class="fas fa-times"></i>
    </div>
    <div id="void" onclick="closeNav()">

    </div>
      <div class="news-categories-mobile">
        <ul id="news-list-container-mobile" class="news-cat-container">
          <li id="news-mobile">
            <a href="#" id="news-link">News</a>
          </li>
          <li id="politics-mobile">
            <a href="./category.html" id="politics-link">Politics</a>
          </li>
          <li id="sports-mobile">
            <a href="./category.html" id="sports-link">Sports</a>
          </li>
          <li id="culture-mobile">
            <a href="./category.html" id="culture-link">Culture</a>
          </li>
          <li id="business-mobile">
            <a href="./category.html" id="business-link">Business</a>
          </li>
          <li id="entertainment-mobile">
            <a href="./category.html" id="entertainment-link">Entertainment</a>
          </li>
          <li id="science-technology-mobile">
            <a href="./category.html" id="science-technology-link">Technology</a>
          </li>
        </ul>
      </div>
    </div>
    <header id="header">
      <nav id="navbar">
        <div id="logo">
          <img src="./public/Images/Untitled-2.png" alt="ANF-tv">
        </div>
        <div id="news-categories">
          <ul id="news-list-container" class="news-cat-container">
            <li id="news">
              <a href="#" id="news-link">News</a>
            </li>
            <li id="politics">
              <a href="./category.html" id="politics-link">Politics</a>
            </li>
            <li id="sports">
              <a href="./category.html" id="sports-link">Sports</a>
            </li>
            <li id="culture">
              <a href="./category.html" id="culture-link">Culture</a>
            </li>
            <li id="business">
              <a href="./category.html" id="business-link">Business</a>
            </li>
            <li id="entertainment">
              <a href="./category.html" id="entertainment-link">Entertainment</a>
            </li>
            <li id="science-technology">
              <a href="./category.html" id="science-technology-link">Technology</a>
            </li>
          </ul>
        </div>
        <div id="search">
          <input type="search" name="search" placeholder="Search" id="search-input">
          <button id="search-button">
            <img id="search-img" src="./public/Images/Search.png" alt="search-icon" id="search-icon">
          </button>
        </div>
        <div id="hamburger" onclick="openNav()">
          <i class="fas fa-bars"></i>
        </div>
      </nav>
      <hr id="nav-border">
    </header>
  <main id="add-news-main">
    <section id="form-section">
      <form id="form" method="post" action="http://localhost:3000/news/create">
        
        <h2 id="form-header">
          Add News
        </h2>
        <input type="text" name="subject" placeholder="Subject" id="subject-input">
        <input list="categories" name="category" placeholder="category" id="category">
        <datalist id="categories">
          <option value="Politics">
          <option value="Sports">
          <option value="Culture">
          <option value="Business">
          <option value="Entertainment">
          <option value="Science/ Technology">
        </datalist>
        <div id="checkboxes">
        <label for="top-story">Top story</label>
        <input type="checkbox" name="top-story" id="top-story">
        <label for="editors-pick">Editor's pick</label>
        <input type="checkbox" name="editors-pick" id="editors-pick">
        </div>
        <div id="media">
          <label for="media" id="media-upload-label">Media</label>
          <input type="file" id="media-upload-input" name="media" accept="video/*image/*">
      </div>
      <textarea name="news" id="content" placeholder="News content"></textarea>
      <div id="response-container">
        <p id="response">
        </p>
      </div>
      <div id="submit-container">
      <input type="submit" value="Add" id="add-news-submit">
      </div>
      </form>
      
    </section>
  </main>
  <footer id="footer">
    <div id="anf-tv-ads">
      <img class="footer-ads-img" src="./public/Images/Untitled-2.png" alt="" id="ad-img">
    </div>
    <div id="footer-nav">
      <div id="left-p">
        <p id="company" class="company">
          <a class="footer-p-link" href="">Company </a>
        </p>
      </div>
      <div id="center-icon">
        <img src="./public/Images/Untitled-2.png" alt="Company Icon" id="company-icon" class="company-icon">
      </div>
      <div id="right-p">
        <p id="helpdesk" class="helpdesk">
          <a class="footer-p-link" href=""> Help desk </a>
        </p>
      </div>
    </div>
    <hr style="border: #2201f9 solid 0.5px;">
    <div id="footer-contact">
      <a href="https://web.facebook.com/watch/ANFTV.NET/" target="_blank">
      <i class="fab fa-facebook"></i>
      </a>
      <a href="" target="_blank">
      <i class="fab fa-twitter"></i>
      </a>
      <a href="" target="_blank">
      <i class="fab fa-instagram"></i>
      </a>
      <a href="" target="_blank">
        <i class="fab fa-youtube"></i>
      </a>
    </div>
    <p id="footer-copy-right">
      Â© ANF-tv, Inc. 2022. Thank you for visiting.
    </p>
  </footer>
  <script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"></script>
  <script src="./js/index.js"></script>
  <script type="text/javascript">

const toBase64 = file => new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);
  });

$('#form').submit(function(event) {
  event.preventDefault(); // Prevent the form from submitting via the browser

  const uploadedFile = document.getElementById('media-upload-input').files[0];
  if (!uploadedFile) {
    // console.log('Please attach media');
          $("#response").html('Please attach media');
    
  } else {
    toBase64(uploadedFile)
  .then((res) => {
    // console.log(res);
    let mediaBase64 = res;
    var subject = $("#subject-input").val();
        var category = $("#category").val();
        var editorsPick = $("#editors-pick").val();
        var topStory = $("#top-story").val();
        var media = mediaBase64;
        var content = $("#content").val();
        var news = {
              subject,
              category,
              topStory,
              editorsPick,
              media,
              content
        };
        // console.log(content);
        var newsData = JSON.stringify(news);
        if ((subject == "") || 
            (category == "") || 
            (media == "") || 
            (content == "")) {
          // console.log('Please fill all input fields');
          $("#response").html('Please fill all input fields');
        } else {
      $.ajax({
        type: "POST",
        contentType: "application/json",
        dataType: "json",
        url: 'https://crossorigin.me/https://anf-tv.herokuapp.com/news/create',
        data: newsData,
        processData: false,
        success: function (response) {
        // console.log('success');
        // console.log(response);
          $("#response").html(response.message);
          window.location = "admin-landing.html";
      },
        error: function(xhr, status, error) {
        let resError = xhr.responseText
      //  console.log('error');
      //  console.log(resError);
        $("#response").html(resError.message);
        // Optionally alert the user of an error here...
        }
  });
}   
  })
  .catch((err) => {
    console.log(err)
  })
  };
     // Prevent the form from submitting via the browser
       
});
  </script>
</body>
</html>